<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Test Ã“c ChÃ³ â€” Quiz Troll</title>
<style>
  :root{
    --bg:#0f1724; --card:#0b1220; --accent:#ff5d8f; --muted:#9aa4b2;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
  body{background:linear-gradient(180deg,#061226,#0f1724);display:flex;align-items:center;justify-content:center;padding:12px;color:#e6eef8}
  .app{width:100%;max-width:520px}
  header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#ff9a66);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800}
  h1{margin:0;font-size:18px}
  p.lead{margin:0;color:var(--muted);font-size:13px}
  .card{background:linear-gradient(180deg,var(--card),#071028);border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,0.6)}
  .progress{height:8px;background:#071725;border-radius:8px;overflow:hidden;margin-bottom:12px}
  .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#ffb86b);width:0%}
  .question{font-size:16px;margin-bottom:10px}
  .choices{display:flex;flex-direction:column;gap:8px}
  .choice{background:#081829;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;transition:transform .08s}
  .choice:active{transform:scale(.99)}
  .muted{color:var(--muted);font-size:13px;margin-top:8px}
  .footer{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:12px}
  .btn{background:var(--accent);color:#fff;border:0;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer}
  .small{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 10px;border-radius:8px}
  #resultCard{display:none;text-align:center}
  .bigScore{font-size:44px;font-weight:900;color:#fff;margin:8px 0}
  .roast{font-size:16px;color:#ffd6e1;margin-top:8px}
  .confetti{pointer-events:none;position:fixed;left:0;top:0;width:100%;height:100%;z-index:9999}
  footer{margin-top:12px;text-align:center;color:var(--muted);font-size:12px}
  @keyframes wiggle{0%{transform:rotate(-5deg)}50%{transform:rotate(5deg)}100%{transform:rotate(-5deg)}}
  .logo.angry{animation:wiggle .6s ease-in-out}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="logo">ğŸ¤ª</div>
    <div>
      <h1>Test Ã“c ChÃ³ â€” Quiz Troll</h1>
      <p class="lead">10 cÃ¢u báº«y â€” tráº£ lá»i Ä‘Æ°á»ng nÃ o cÅ©ng â€œÃ³c chÃ³â€ â€” dÃ nh cho team láº§y ğŸ˜‚</p>
    </div>
  </header>

  <div class="card" id="quizCard">
    <div class="progress"><i id="bar"></i></div>
    <div id="qbox">
      <div class="question" id="qtext">Äang táº£i cÃ¢u há»i...</div>
      <div class="choices" id="choices"></div>
      <div class="muted">Chá»‰ cáº§n chá»n 1 Ä‘Ã¡p Ã¡n â€” tráº£ lá»i tháº­t hoáº·c troll Ä‘á»u Ä‘Æ°á»£c.</div>
    </div>

    <div id="resultCard" class="card" style="margin-top:12px;">
      <div id="resultTop">
        <div style="font-size:16px;font-weight:800">Káº¾T QUáº¢</div>
        <div class="bigScore" id="scoreText">100% Ã“C CHÃ“</div>
        <div class="roast" id="roastText">Báº¡n xá»©ng danh... Ã³c chÃ³ chÃ­nh hiá»‡u ğŸ¶ğŸ’¥</div>
        <div style="margin-top:12px">
          <button class="btn" id="shareBtn">LÆ°u & Chia sáº» Ä‘á»ƒ troll báº¡n bÃ¨</button>
          <button class="small" id="retryBtn">LÃ m láº¡i (10 cÃ¢u má»›i)</button>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="muted" id="qcount">CÃ¢u 0 / 10</div>
      <div>
        <button class="small" id="skipBtn">Bá» qua (troll tiáº¿p)</button>
        <button class="btn" id="startBtn">Báº¯t Ä‘áº§u</button>
      </div>
    </div>
  </div>

  <div class="muted" style="margin-top:8px">LÆ°u Ã½: quiz nÃ y chá»‰ mang tÃ­nh giáº£i trÃ­, troll nháº¹ â€” khÃ´ng tháº­t nghiÃªm trá»ng nha!</div>
  <footer>Made with â¤ï¸ â€” Äá»«ng giáº­n, chá»‰ cÆ°á»i thÃ´i ğŸ˜œ</footer>
</div>

<canvas id="confetti" class="confetti"></canvas>
<audio id="pop" preload="auto"><source src="https://assets.mixkit.co/sfx/preview/mixkit-fairy-chimes-807.wav" type="audio/wav"></audio>

<script>
/* ========== Bank cÃ¢u há»i (Ä‘a dáº¡ng, láº§y, trap) ========== 
   Má»—i cÃ¢u cÃ³ text vÃ  4 Ä‘Ã¡p Ã¡n (chuáº©n) â€” nhÆ°ng note: má»i Ä‘Ã¡p Ã¡n Ä‘á»u dáº«n Ä‘áº¿n troll.
*/
const questionBank = [
  {q:"Báº¡n Ä‘i chá»£, tháº¥y 1kg tÃ¡o ghi 'MUA 1 Táº¶NG 1', báº¡n sáº½:", a:["Mua 2kg luÃ´n", "Äá»£i Ä‘áº¿n khi háº¿t khuyáº¿n mÃ£i", "Há»i ngÆ°á»i bÃ¡n cÃ³ cháº¯c khÃ´ng", "Mua 1 Äƒn 1 ngay trÃªn chá»—"], tip:"Cáº©n tháº­n, tÃ¡o cÃ³ thá»ƒ lÃ  hÃ nh!"},

  {q:"Khi ai Ä‘Ã³ nháº¯n 'Äang ráº£nh k?', báº¡n tráº£ lá»i tháº¿ nÃ o cho lá»‹ch sá»±?", a:["Ráº£nh chá»©, muá»‘n gÃ¬?", "KhÃ´ng ráº£nh nhÆ°ng nháº¯n láº¡i luÃ´n", "Gá»­i sticker cute", "Gá»i video cho hoÃ nh trÃ¡ng"], tip:"Chá»n kiá»ƒu nÃ o cÅ©ng dá»… dÃ­nh báº«y láº¯m nha."},

  {q:"Náº¿u Ä‘iá»‡n thoáº¡i rÆ¡i xuá»‘ng nÆ°á»›c, viá»‡c Ä‘áº§u tiÃªn báº¡n lÃ m lÃ :", a:["Báº­t cháº¿ Ä‘á»™ mÃ¡y bay", "Äáº­p Ä‘iá»‡n thoáº¡i cho khÃ´", "Bá» vÃ o gáº¡o 24 giá»", "Cáº§u nguyá»‡n"], tip:"PhÆ°Æ¡ng phÃ¡p khoa há»c? Gáº¡o chá»‰ cho cáº£m giÃ¡c thÃ´i."},

  {q:"Báº¡n Ä‘ang mua cÆ¡m, ngÆ°á»i bÃ¡n báº£o 'HÃ´m nay thÃªm 1 miáº¿ng thá»‹t miá»…n phÃ­', báº¡n:", a:["CÆ°á»i nháº­n ngay", "Kiá»ƒm tra xem thá»‹t lÃ  thá»‹t gÃ¬", "Há»i vÃ¬ sao miá»…n phÃ­", "KhÃ´ng tin, bá» Ä‘i"], tip:"Miá»…n phÃ­ lÃ  art â€” Äƒn Ä‘i Ä‘á»«ng há»i! "},

  {q:"Khi nhÃ¬n Ä‘á»“ng há»“ tháº¥y 13:13, báº¡n tin Ä‘Ã³ lÃ  dáº¥u hiá»‡u may máº¯n khÃ´ng?", a:["Táº¥t nhiÃªn! 13:13 may máº¯n", "KhÃ´ng, 13 viá»‡c gÃ¬ may", "Chá»¥p hÃ¬nh Ä‘Äƒng story", "Thá»•i 13 láº§n Ä‘á»ƒ cháº¯c cháº¯n"], tip:"Sá»‘ Ä‘áº¹p hay xáº¥u lÃ  do báº¡n nghÄ©."},

  {q:"Báº¡n Ä‘Æ°á»£c táº·ng 1 cÃ¢y káº¹o, thá»Ÿ phÃ o vÃ¬ Ä‘Ã³i. Báº¡n lÃ m gÃ¬?", a:["Ä‚n liá»n", "Kiá»ƒm tra háº¡n sá»­ dá»¥ng", "Chia 1 ná»­a cho báº¡n", "Giá»¯ láº¡i lÃ m ká»· niá»‡m"], tip:"Ä‚n liá»n lÃ  báº£n nÄƒng sá»‘ng sÃ³t."},

  {q:"Báº¡n tháº¥y 1 thÃ´ng bÃ¡o 'Báº¡n trÃºng thÆ°á»Ÿng iPhone', trÆ°á»›c khi click báº¡n:", a:["Nháº£y lÃªn vÃ¬ vui", "Kiá»ƒm tra link cÃ³ 'http' hay khÃ´ng", "Gá»i báº¡n bÃ¨ há»i cÃ³ tháº­t khÃ´ng", "Nhá» máº¹ kiá»ƒm tra"], tip:"Link lá»«a Ä‘áº£o chuyÃªn nghiá»‡p Ä‘áº¥y nhÃ©."},

  {q:"Báº¡n Ä‘ang Ä‘Æ°á»ng, tháº¥y 1 chÃº chÃ³ dá»… thÆ°Æ¡ng. Báº¡n pháº£n á»©ng?", a:["Cháº¡y láº¡i Ã´m ngay", "NhÃ¬n tá»« xa vÃ  há»i chá»§", "Quay clip Ä‘Äƒng TikTok", "Cho nÃ³ Äƒn xÃºc xÃ­ch"], tip:"ChÃ³ dá»… thÆ°Æ¡ng, Ã³c chÃ³ dá»… bá»‹ tan cháº£y."},

  {q:"SÃ¡ng nay báº¡n quÃªn mang vÃ­, nhÆ°ng váº«n 'tá»± tin' Ä‘i mua trÃ  sá»¯a. Báº¡n:", a:["DÃ¹ng app chuyá»ƒn tiá»n luÃ´n", "Cháº¡y vá» láº¥y vÃ­", "NÄƒn ná»‰ tá»¥i báº¡n tráº£ há»™", "Ã”m cá»‘c mÃ  Ä‘i vá»"], tip:"TrÃ  sá»¯a cÃ³ thá»ƒ chá», nhÆ°ng lÃ²ng tá»± trá»ng thÃ¬ sao?"},

  {q:"Báº¡n rá»§ crush Ä‘i Äƒn, crush tráº£ lá»i 'Ok' nhÆ°ng khÃ´ng bao giá» Ä‘i. Báº¡n:", a:["Gá»­i 100 tin nháº¯n", "Chá»‹u thua vÃ  quÃªn Ä‘i", "Äá»•i crush khÃ¡c", "Tá»• chá»©c sá»± kiá»‡n 'Ä‘á»£i crush'"], tip:"Äá»£i crush lÃ  thá»­ thÃ¡ch siÃªu nhÃ¢n."},

  {q:"Báº¡n xem 1 máº¹o 'tháº¥y 1 Ä‘á»‘ng tiá»n trÃªn Ä‘Æ°á»ng thÃ¬ lÃ m sao?', báº¡n:", a:["Nháº·t bá» tÃºi", "ÄÆ°a cho cÃ´ng an", "Check cÃ³ camera khÃ´ng", "Äá»ƒ láº¡i vÃ  ngÃ³ lÆ¡"], tip:"Tiá»n rÆ¡i lÃ  cÃ¡m dá»— level pro."},

  {q:"Báº¡n há»c online, tháº§y há»i 'Ai lÃ m bÃ i?', báº¡n:", a:["GiÆ¡ tay tháº­t cao", "Im láº·ng vÃ¬ sá»£ sai", "Viáº¿t Ä‘Ã¡p Ã¡n copy paste", "Báº­t micro ca 1 bÃ i"], tip:"Há»c cÅ©ng cáº§n phong cÃ¡ch!"},

  {q:"Báº¡n tháº¥y meme 'Äƒn mÃ¬ tÃ´m pha nÆ°á»›c trÃ ', báº¡n thá»­ ngay chá»©?", a:["Thá»­ luÃ´n", "KhÃ´ng, coi láº¡i recipe", "Chá»‰ like thÃ´i", "Gá»­i cho há»™i báº¡n thá»­"], tip:"MÃ¬ + trÃ  = tÃ¬nh báº¡n bá»n vá»¯ng?"},

  {q:"Báº¡n mua vÃ© xem phim, Ä‘áº¿n ráº¡p má»›i nhá»› quÃªn kÃ­nh 3D. Báº¡n:", a:["Äeo kÃ­nh rá»—ng tá»± cháº¿", "Xem phim 2D váº«n á»•n", "ÄÃ²i tiá»n láº¡i", "Chá»¥p hÃ¬nh check-in cho oai"], tip:"Oai hay khÃ´ng oai, lÃ  do báº¡n."},

  {q:"Báº¡n tháº¥y 'bÃ­ kÃ­p ngá»§ 5 phÃºt lÃ  tá»‰nh tÃ¡o cáº£ ngÃ y', báº¡n lÃ m thá»­ chá»©?", a:["LÃ m thá»­ liá»n", "Nghi ngá» rá»“i thÃ´i", "Xem review trÃªn YouTube", "Viáº¿t 1 bÃ i praise"], tip:"Giáº¥c ngá»§ quÃ½ hÆ¡n vÃ ng."},

  {q:"Báº¡n Ä‘Æ°á»£c má»i lÃ m 'Ä‘a nhiá»‡m siÃªu nhÃ¢n' trong 1 ngÃ y, báº¡n:", a:["Cháº¥p nháº­n vÃ  ngá»§ 0 tiáº¿ng", "Tá»« chá»‘i vÃ¬ sá»£ kiá»‡t sá»©c", "LÃªn plan chi tiáº¿t tá»«ng phÃºt", "Nhá» AI lÃ m há»™"], tip:"Äa nhiá»‡m: tin hay khÃ´ng thÃ¬ tÃ¹y báº¡n."},

  {q:"Crush nháº¯n 'cÃ³ chuyá»‡n nÃ³i', báº¡n reply ngay sao cho cute?", a:["'Mau ká»ƒ Ä‘i, bÃ© Ä‘Ã¢y nghe nÃ¨'", "'GÃ¬ gÃ¬ nÃ³i mau'", "'CÃ³ chuyá»‡n gÃ¬ há»‘t láº¹'", "'Sáºµn sÃ ng 24/7'"], tip:"Cute level quyáº¿t Ä‘á»‹nh outcome."},

  {q:"Báº¡n tháº¥y 'cÃ¢y 5 lÃ¡ tiáº¿t lá»™ tÃ­nh cÃ¡ch', báº¡n nhÃ¬n cÃ¢y hoa trÆ°á»›c nhÃ  vÃ :", a:["Äáº¿m lÃ¡ ngay", "Chá»¥p up story", "Æ¯Æ¡m 1 cÃ¢y khÃ¡c", "Ngá»“i thiá»n cáº¡nh nÃ³"], tip:"TÃ­nh cÃ¡ch hay cÃ¢y cáº£nh má»›i lÃ  cÃ¢u há»i."},

  {q:"Báº¡n lá»¡ reply tin nháº¯n 'ok' thay vÃ¬ 'okeee', báº¡n:", a:["XÃ³a rá»“i gá»­i láº¡i 'okeee'", "Äá»ƒ yÃªn vÃ¬ Ä‘Ã£ lá»¡", "Gá»­i sticker bÃ¹ Ä‘áº¯p", "Giáº£i thÃ­ch 1 Ä‘oáº¡n dÃ i"], tip:"CÃ¡ch reply quyáº¿t Ä‘á»‹nh level láº§y."},

  {q:"Báº¡n Ä‘ang Ä‘Ã³i, tháº¥y bÃ¡nh mÃ¬ dá»Ÿ, báº¡n:", a:["Ä‚n cho háº¿t", "NÃ³i 'thÃ´i Ä‘á»«ng phÃ­'", "Chia cho báº¡n", "Cáº¥t vÃ o tá»§"], tip:"Bá»¯a Äƒn = quyáº¿t Ä‘á»‹nh Ä‘áº¡o Ä‘á»©c nhá»."},

  {q:"Báº¡n tháº¥y 1 challenge 'nháº£y 10 cÃ¡i trong 10s', báº¡n:", a:["Quáº©y luÃ´n", "Xem 1 clip trÆ°á»›c", "NÃ³i 'Ä‘á»£i tÃ­' rá»“i chÆ¡i", "Gá»i team support"], tip:"Thá»­ thÃ¡ch hoáº·c táº©u thoÃ¡t."},

  {q:"Báº¡n Ä‘i siÃªu thá»‹, tháº¥y 1 nÃºt 'báº¥m Ä‘á»ƒ thá»­ quÃ ', báº¡n:", a:["Báº¥m luÃ´n", "Xem xung quanh trÆ°á»›c", "Chá»‰ báº¥m náº¿u khÃ´ng ai nhÃ¬n", "QuÃªn luÃ´n"], tip:"CÃ¡m dá»— má»i nÆ¡i má»i lÃºc."},

  {q:"Báº¡n muá»‘n tá» tÃ¬nh, cÃ¡ch láº§y nháº¥t lÃ :", a:["Gá»­i 100 dÃ²ng thÆ¡ auto", "Tá» tÃ¬nh báº±ng meme", "Náº¥u 1 mÃ³n dá»Ÿ rá»“i táº·ng", "Nháº£y flashmob trÆ°á»›c cá»­a"], tip:"Tá» tÃ¬nh = nghá»‡ thuáº­t vÃ  may rá»§i."},

  {q:"Báº¡n lÃ m máº¥t chÃ¬a khÃ³a phÃ²ng, bÆ°á»›c tiáº¿p theo:", a:["TÃ¬m má»i ngÃ³c ngÃ¡ch", "Gá»i thá»£ khÃ³a ngay", "BÃ³c 1 gÃ³i snack Ä‘á»ƒ bá»›t khÃ³ chá»‹u", "Ngá»“i khÃ³c 10 phÃºt rá»“i tÃ¬m"], tip:"TÃ¢m tráº¡ng áº£nh hÆ°á»Ÿng giáº£i phÃ¡p."}
];

/* ========== App logic ========== */
const TOTAL = 10;
let questions = [];
let idx = 0;
let answers = [];
const bar = document.getElementById('bar');
const qtext = document.getElementById('qtext');
const choicesEl = document.getElementById('choices');
const qcount = document.getElementById('qcount');
const startBtn = document.getElementById('startBtn');
const skipBtn = document.getElementById('skipBtn');
const logo = document.querySelector('.logo');
const pop = document.getElementById('pop');
const confettiCanvas = document.getElementById('confetti');
confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight;

/* pick random unique questions */
function pickQuestions(){
  const pool = [...questionBank];
  const res = [];
  while(res.length < TOTAL && pool.length){
    const i = Math.floor(Math.random()*pool.length);
    res.push(pool.splice(i,1)[0]);
  }
  return res;
}

/* start */
startBtn.addEventListener('click', ()=>{
  questions = pickQuestions();
  idx = 0; answers = [];
  document.getElementById('quizCard').style.height = 'auto';
  document.getElementById('resultCard').style.display = 'none';
  document.getElementById('qbox').style.display = 'block';
  startBtn.style.display = 'none';
  renderQuestion();
});

/* skip */
skipBtn.addEventListener('click', ()=>{
  if(!questions.length) return;
  idx++;
  answers.push({skipped:true});
  if(idx >= TOTAL) showResult();
  else renderQuestion();
});

/* render */
function renderQuestion(){
  const cur = questions[idx];
  qtext.innerHTML = `<strong>${cur.q}</strong>`;
  choicesEl.innerHTML = '';
  cur.a.forEach((opt,i)=>{
    const b = document.createElement('div');
    b.className = 'choice';
    b.innerText = opt;
    b.onclick = ()=>{ selectOption(i); };
    choicesEl.appendChild(b);
  });
  qcount.innerText = `CÃ¢u ${idx+1} / ${TOTAL}`;
  bar.style.width = `${((idx)/TOTAL)*100}%`;
}

/* on select (we record but result will troll regardless) */
function selectOption(i){
  answers.push({q:questions[idx], choice:i});
  // little animation
  logo.classList.add('angry');
  setTimeout(()=>logo.classList.remove('angry'),350);
  // small sound & vib
  try{ pop.currentTime=0; pop.play().catch(()=>{}); }catch(e){}
  if(navigator.vibrate) navigator.vibrate(80);
  // next
  idx++;
  if(idx >= TOTAL) showResult();
  else renderQuestion();
}

/* show result: always láº§y; choose a playful roast and percent (mostly high) */
function showResult(){
  document.getElementById('qbox').style.display = 'none';
  document.getElementById('resultCard').style.display = 'block';
  bar.style.width = `100%`;

  // compute a fake score but biased high; also inject slight variation
  const base = 80 + Math.floor(Math.random()*21); // 80..100
  // if user skipped many, slightly higher (troll)
  const skipped = answers.filter(a=>a.skipped).length;
  const score = Math.min(100, base + skipped*2);

  const scoreText = document.getElementById('scoreText');
  scoreText.innerText = `${score}% Ã“C CHÃ“`;
  const roastText = document.getElementById('roastText');

  // pick roast lines
  const roasts = [
    "Báº¡n xá»©ng Ä‘Ã¡ng cáº§m cá» Ä‘á»™i Ã“c ChÃ³ chÃ­nh hiá»‡u ğŸ†ğŸ¶",
    "Trá»i Æ¡i, má»©c Ã³c chÃ³ cá»§a báº¡n khiáº¿n ai cÅ©ng pháº£i ngÆ°á»›c nhÃ¬n ğŸ˜…",
    "Nháº¯m máº¯t láº¡i vÃ  tÆ°á»Ÿng tÆ°á»£ng báº¡n vá»«a cháº¡m tá»›i level 'Ã³c chÃ³ pro' ğŸ’¥",
    "Báº¡n lÃ m tá»• chá»©c Ã“c ChÃ³ rá»™n rÃ ng hÆ¡n â€” chÃºc má»«ng nhÃ©! ğŸ‰",
    "Ã”i dÃ o, báº¡n láº§y tá»›i má»©c nhÃ  sáº£n xuáº¥t pháº£i thÃªm cáº£nh bonus ğŸ˜‚"
  ];
  const advice = [
    "Lá»i khuyÃªn: uá»‘ng 1 cá»‘c nÆ°á»›c, thá»Ÿ 3 láº§n, rá»“i lÃ m láº¡i thá»­ xem nhÃ©.",
    "Tip nhá»: gá»­i quiz nÃ y cho crush Ä‘á»ƒ há» biáº¿t báº¡n dá»… thÆ°Æ¡ng láº§y tá»›i Ä‘Ã¢u.",
    "Máº¹o sá»‘ng sÃ³t: Ä‘á»«ng tham gia challenge cÃ³ báº«y ná»¯a â€” trá»« khi muá»‘n láº§y hÆ¡n.",
    "Gá»£i Ã½: chá»¥p áº£nh Ä‘iá»ƒm sá»‘ nÃ y vÃ  khoe cho team Ä‘á»ƒ cÃ¹ng cÆ°á»i."
  ];
  roastText.innerText = roasts[simpleHash(JSON.stringify(answers)) % roasts.length] + " â€” " + advice[simpleHash(String(score)) % advice.length];

  // confetti & sound
  doConfetti();
  try{ pop.currentTime=0; pop.play().catch(()=>{}); }catch(e){}
}

/* confetti */
function doConfetti(){
  const ctx = confettiCanvas.getContext('2d');
  const pieces = [];
  for(let i=0;i<120;i++){
    pieces.push({
      x: Math.random()*confettiCanvas.width,
      y: Math.random()*-confettiCanvas.height,
      vx: Math.random()*2-1,
      vy: Math.random()*3+2,
      size: Math.random()*8+4,
      color: ['#ff5d8f','#ffd166','#6ee7b7','#4cc9f0','#c77dff'][Math.floor(Math.random()*5)]
    });
  }
  let t=0;
  const iv = setInterval(()=>{
    t++;
    ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
    pieces.forEach(p=>{
      p.x += p.vx;
      p.y += p.vy;
      ctx.fillStyle = p.color;
      ctx.fillRect(p.x, p.y, p.size, p.size*0.6);
    });
    if(t>120){ clearInterval(iv); ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); }
  },16);
}

/* buttons */
document.getElementById('retryBtn').addEventListener('click', ()=>{
  // reset UI
  startBtn.style.display='inline-block';
  document.getElementById('resultCard').style.display='none';
  document.getElementById('qbox').style.display='block';
  bar.style.width='0%';
  qcount.innerText = `CÃ¢u 0 / ${TOTAL}`;
});
document.getElementById('shareBtn').addEventListener('click', ()=>{
  // simple share: snapshot minimal card
  const c = document.createElement('canvas'); c.width=800; c.height=600;
  const g = c.getContext('2d');
  g.fillStyle='#061226'; g.fillRect(0,0,c.width,c.height);
  g.fillStyle='#fff'; g.font='bold 36px Arial'; g.fillText('Test Ã“c ChÃ³', 28,60);
  g.font='28px Arial'; g.fillText(document.getElementById('scoreText').innerText, 28,120);
  g.font='20px Arial'; g.fillText(document.getElementById('roastText').innerText, 28,180);
  const a = document.createElement('a'); a.href=c.toDataURL('image/png'); a.download='occho.png'; a.click();
});

/* small helpers */
function simpleHash(s){
  s = (s||'').toString().toLowerCase().trim();
  let h=0; for(let i=0;i<s.length;i++) h = (h*31 + s.charCodeAt(i)) | 0;
  return Math.abs(h);
}

/* accessibility: start on Enter */
document.addEventListener('keydown', e=>{
  if(e.key==='Enter' && startBtn.style.display !== 'none') startBtn.click();
});

/* init */
qcount.innerText = `CÃ¢u 0 / ${TOTAL}`;
bar.style.width = '0%';
</script>
</body>
</html>
